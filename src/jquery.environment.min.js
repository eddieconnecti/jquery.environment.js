!function(n){var e=function(e,i){var t=n(e),r=this,o=n.extend({development:{flag:!0,explicit:!1,uri:"http://dev.mydomain.com",links:{"a#mylink":"http://dev.mydomain.com/home"},hidden:null},review:{flag:!0,explicit:!1,uri:"http://rvw.mydomain.com",links:{"a#mylink":"http://rvw.mydomain.com/home"},hidden:null},productive:{flag:!1,explicit:!1,uri:null,links:null,hidden:null}},i||{}),a={devtools:!1,environment:null,prev_environment:null,flag:null};this.setEnvironment=function(n){o.hasOwnProperty(n)&&a.environment!=n&&(a.prev_environment=a.environment,a.environment=n,a.prev_environment&&(l(a.prev_environment,!1),d(a.prev_environment,!1)),l(a.environment,!0),d(a.environment,!0),v(o[a.environment].flag))},this.setDevtools=function(n){n!=a.devtools&&(a.devtools=n,a.environment&&o[a.environment]&&v(o[a.environment].flag))},this.setExplicitEnvironment=function(n){var e=h();n!=e&&(o.hasOwnProperty(e)&&(o[e].explicit=!1),o.hasOwnProperty(n)&&(o[n].explicit=!0,r.setEnvironment(n)))};var d=function(e,i){if(e&&o.hasOwnProperty(e)&&o[e].hidden&&n.isArray(o[e].hidden))for(var r=0;r<o[e].hidden.length;r++){var a=t.find(o[e].hidden[r]);a&&a.length&&a.each(i?function(){n(this).data("prev-hidden",n(this).is(":hidden")),n(this).hide()}:function(){n(this).data("prev-hidden")||n(this).show(),n(this).removeData("prev-hidden")})}},l=function(e,i){if(e&&o.hasOwnProperty(e)&&o[e].links)for(var r in o[e].links)t.find(r).each(i?function(){n(this).data("prev-href",n(this).attr("href")),n(this).attr("href",o[e].links[r])}:function(){n(this).attr("href",n(this).data("prev-href")),n(this).data("prev-href",null)})},v=function(e){if(a.devtools){if(!a.flag){var i=["<style>","  .environment-flag {","    background: #ff0000;","    color: #fff;","    position: fixed;","    top: 2%;","    padding: 6px;","    right: 2%;","    z-index: 5000;","    -webkit-box-shadow: 2px 4px 16px -2px rgba(0,0,0,0.75);","    -moz-box-shadow: 2px 4px 16px -2px rgba(0,0,0,0.75);","    box-shadow: 2px 4px 16px -2px rgba(0,0,0,0.75);","    border-radius: 5px;","    -moz-border-radius: 5px;","    -webkit-border-radius: 5px; ","    border: 1px solid #ff4040;","  }","  .environment-flag .body {","    text-transform: capitalize;","    text-shadow: 0 0 2px #910000;","  }","  .environment-flag .footer {","    color: #910000;","    padding-top: 6px;","  }","  .environment-flag .footer a {","    background: #ff4040;","    color: #910000;","    font-size: 9px;","    padding: 2px;","    text-transform: capitalize;","  }","  .environment-flag .footer a:hover {","    background: #910000;","    color: #ff4040;","  }","</style>"].join("\n");t.append(n(i)),a.flag=n('<div class="environment-flag"><div class="body"></div><div class="footer"></div></div>'),a.flag.appendTo(t)}var d,l;a.flag.find(".body").text(a.environment?f(a.environment):"").attr("title",a.environment?"Panel defined by jquery.environment Plugin":""),d=[];for(l in o)l!=a.environment&&d.push('<a href="#" data-environment="'+l+'" title="Change current Environment to '+f(l)+'">'+f(l)+"</a>");a.flag.find(".footer").html(d.join(" | ")),a.flag.find("a").on("click",function(e){e.preventDefault(),n(this).attr("data-environment")&&r.setExplicitEnvironment(n(this).attr("data-environment"))}),e?a.flag.show():a.flag.hide()}},f=function(n){return n.charAt(0).toUpperCase()+n.slice(1)},s=function(){var n=h();if(n)return n;var e=window.location.toString().toLowerCase();for(n in o)if(o[n].uri&&e.indexOf(o[n].uri.toLowerCase())>-1)return n;return null},h=function(){for(var n in o)if(o[n].explicit)return n;return null},p=function(){setInterval(function(n){var e=160;n.setDevtools(window.Firebug&&window.Firebug.chrome&&window.Firebug.chrome.isInitialized||window.outerWidth-window.innerWidth>e||window.outerHeight-window.innerHeight>e?!0:!1)},500,r),r.setEnvironment((environment=s())?environment:"productive")};p()};n.environment=function(i){return n("body").each(function(){var t=n(this);if(!t.data("environmentPlugin")){var r=new e(this,i);t.data("environmentPlugin",r)}})}}(jQuery);
